<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis Hechos - MetaMapa</title>

    <link rel="stylesheet" th:href="@{/css/global.css}">
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>

<div th:replace="~{fragments/header :: header}"></div>

<main>
    <div class="container">

        <div class="page-header">
            <h1 class="page-title">Mis Hechos</h1>
            <p class="page-subtitle">Gestiona tus contribuciones al mapa.</p>
        </div>

        <div th:if="${errorGlobal}" class="api-error-alert">
            <p th:text="${errorGlobal}"></p>
        </div>

        <div class="dashboard-grid" th:if="${not #lists.isEmpty(hechos)}">

            <div class="dashboard-card" th:each="hecho : ${hechos}">

                <div class="card-status-header">
                    <span class="estado-badge"
                          th:classappend="'estado-' + ${hecho.estado}"
                          th:text="${hecho.estado}">ESTADO</span>
                </div>

                <div class="card-body">

                    <h3 class="card-title" th:text="${hecho.titulo}">Título del Hecho</h3>

                    <p class="card-excerpt" th:text="${hecho.descripcion}">
                        Descripción corta...
                    </p>

                    <div class="card-meta-section">

                        <div class="meta-row" th:if="${hecho.categoria != null}">
                            <svg class="meta-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
                            </svg>
                            <span th:text="${hecho.categoria}">Categoría del hecho</span>
                        </div>

                        <div class="meta-row" th:if="${hecho.fechaHecho != null}">
                            <svg class="meta-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                            <span th:text="${#temporals.format(hecho.fechaHecho, 'dd/MM/yyyy HH:mm')}">01/01/2025 00:00</span>
                        </div>
                    </div>
                </div>

                <div class="card-footer">
                    <a th:href="@{|/hechos/${hecho.id}/detalle|}"
                       class="btn btn--primary"
                       style="flex: 1;">
                        Ver Detalle
                    </a>

                    <a th:if="${hecho.estado == 'ACEPTADO'}"
                       th:href="@{|/hechos/${hecho.id}/editar|}"
                       class="btn btn--secondary"
                       style="flex: 1;">
                        Editar
                    </a>
                </div>
            </div>
        </div>

        <div class="empty-state" th:if="${#lists.isEmpty(hechos)}">
            <h3>Aún no has subido hechos</h3>
            <p style="color: #64748b; margin-bottom: 25px;">
                Tus contribuciones ayudan a construir la memoria colectiva.
            </p>
            <a th:href="@{/hechos/subir-hecho}" class="btn btn--primary btn--large">
                Subir mi primer hecho
            </a>
        </div>

    </div>
</main>

<div th:replace="~{fragments/footer :: footer}"></div>

</body>
</html>
